<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Cedric's Gold Coast Holiday</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Core Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* Prevent bounce on iOS */
        body { overscroll-behavior-y: none; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-gray-800">
    <div id="root"></div>

    <script>
        // Ê≥®ÂÜå Service Worker ÂÆûÁé∞Á¶ªÁ∫øÂäüËÉΩ
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- 1. ÂÜÖÁΩÆ SVG ÂõæÊ†á (Á¶ªÁ∫øÂèØÁî®) ---
        const IconBase = ({ children, size = 16, className = "", color = "currentColor" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Icons = {
            Plane: (props) => <IconBase {...props}><path d="M2 12h20"/><path d="M13 2l9 10-9 10"/><path d="M12 22v-4"/><path d="M12 2v4"/></IconBase>,
            Car: (props) => <IconBase {...props}><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></IconBase>,
            Hotel: (props) => <IconBase {...props}><path d="M2 4v16"/><path d="M2 8h18a2 2 0 0 1 2 2v10"/><path d="M2 17h20"/><path d="M6 8v9"/></IconBase>,
            MapPin: (props) => <IconBase {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>,
            Utensils: (props) => <IconBase {...props}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></IconBase>,
            AlertTriangle: (props) => <IconBase {...props}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></IconBase>,
            Sun: (props) => <IconBase {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></IconBase>,
            CloudRain: (props) => <IconBase {...props}><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"/><path d="M16 14v6"/><path d="M8 14v6"/><path d="M12 16v6"/></IconBase>,
            Clock: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>,
            Ticket: (props) => <IconBase {...props}><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/></IconBase>,
            Camera: (props) => <IconBase {...props}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></IconBase>,
            Coffee: (props) => <IconBase {...props}><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></IconBase>,
            ShoppingBag: (props) => <IconBase {...props}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></IconBase>,
            CheckCircle: (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>,
            Navigation: (props) => <IconBase {...props}><polygon points="3 11 22 2 13 21 11 13 3 11"/></IconBase>,
            Sparkles: (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M5 5H1"/></IconBase>,
            X: (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>,
            Loader: (props) => <IconBase {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></IconBase>
        };

        const apiKey = ""; 

        const ItineraryApp = () => {
            const [viewMode, setViewMode] = useState('itinerary'); 
            const [activeDay, setActiveDay] = useState(0);
            const [weatherMode, setWeatherMode] = useState('sun'); 
            const [showAiModal, setShowAiModal] = useState(false);
            const [aiLoading, setAiLoading] = useState(false);
            const [aiResponse, setAiResponse] = useState(null);
            const [aiQueryType, setAiQueryType] = useState('weather');

            // --- 3. Ë°åÁ®ãÊï∞ÊçÆ (v6.0 Final) ---
            const itinerary = [
                {
                    day: 0,
                    date: "12Êúà05Êó• (Âë®‰∫î)",
                    title: "Ê∑±Â§úÊΩúÂÖ• | Arrival",
                    location: "Melbourne -> Gold Coast",
                    summary: "ÊôöÁè≠Êú∫ÊäµËææÔºåÊ≥®ÊÑèÊôöÈ§êÂíåËá™Âä©ÂÖ•‰Ωè„ÄÇ",
                    risks: [
                        { type: "critical", msg: "Âá∫ÂèëÂâçÂä°ÂøÖÊãøÂà∞ Nightcap ÂÖ•‰Ωè PIN Á†Å (ÂâçÂè∞ÂèØËÉΩÊó†‰∫∫)ÔºÅ" },
                        { type: "warning", msg: "Nerang Ê∑±Â§úÊó†È§êÔºåÂä°ÂøÖÂú®Â¢®Â∞îÊú¨Êú∫Âú∫ÂêÉÈ•±ÊôöÈ§ê„ÄÇ" }
                    ],
                    timeline: [
                        { time: "18:30", icon: "Car", title: "ÊäµËææÂ¢®Â∞îÊú¨Êú∫Âú∫ (MEL)", desc: "ÂâçÂæÄ T3 Ëà™Á´ôÊ•º" },
                        { time: "19:00", icon: "Utensils", title: "ÊôöÈ§ê (ÂÖ≥ÈîÆ)", desc: "Âú®Êú∫Âú∫ÂêÉÈ•±ÔºåÁ°Æ‰øùÂ≠©Â≠ê‰∏çÈ•ø„ÄÇ" },
                        { time: "20:20", icon: "Plane", title: "Ëµ∑È£û (VA761)", desc: "È£ûË°åÊó∂Èó¥Á∫¶ 2h 10m" },
                        { time: "21:30", icon: "MapPin", title: "ÊäµËææÈªÑÈáëÊµ∑Â≤∏ (OOL)", desc: "ÊèêÂèñË°åÊùéÔºåÂè´ Uber Áõ¥Â•î Nerang" },
                        { time: "22:30", icon: "Hotel", title: "ÂÖ•‰Ωè Nightcap Nerang", desc: "‰ΩøÁî®ÂØÜÁ†ÅÁÆ±Ëá™Âä©ÂÖ•‰ΩèÔºåÂÆâÈùôÊ¥óÊº±Áù°Ëßâ„ÄÇ" }
                    ]
                },
                {
                    day: 1,
                    date: "12Êúà06Êó• (Âë®ÂÖ≠)",
                    title: "Â•ΩËé±ÂùûÁãÇÊ¨¢ | Movie World",
                    location: "Nerang Base",
                    summary: "Âà©Áî®Âú∞ÁêÜ‰ºòÂäøÊîªÂÖãÊúÄËÄó‰ΩìÂäõÁöÑ‰πêÂõ≠„ÄÇ",
                    risks: [],
                    timeline: [
                        { time: "09:00", icon: "Coffee", title: "Êó©È§ê", desc: "ÈÖíÂ∫óÈôÑËøë 7-11 ÊàñÈ∫¶ÂΩìÂä≥ÁÆÄÂçïËß£ÂÜ≥" },
                        { time: "09:30", icon: "Car", title: "Uber ÂâçÂæÄÁîµÂΩ±‰∏ñÁïå", desc: "ËΩ¶Á®ãÁ∫¶ 10 ÂàÜÈíü" },
                        { time: "10:00", icon: "Ticket", title: "Warner Bros. Movie World", desc: "ÂøÖÁé©ÔºöÁâπÊäÄÈ£ûËΩ¶ÁßÄ„ÄÅÊòéÊòüÂ∑°Ê∏∏„ÄÅÂÑøÁ´•È©æÈ©∂Â≠¶Ê†°„ÄÇ" },
                        { time: "11:30", icon: "Utensils", title: "ÈîôÂ≥∞ÂçàÈ§ê", desc: "Âõ≠ÂÜÖËß£ÂÜ≥ÔºåËá™Â∏¶‰∏Ä‰∫õÈõ∂È£ü" },
                        { time: "15:30", icon: "Camera", title: "ÊòéÊòüÂ§ßÊ∏∏Ë°å (ÂøÖÁúã)", desc: "Main Street" },
                        { time: "17:00", icon: "Car", title: "ËøîÂõû Nerang", desc: "Ê≠§Êó∂Â§ßÂÆ∂ÈÉΩÁ¥Ø‰∫ÜÔºåÂõûÈÖíÂ∫ó‰ºëÊÅØ" },
                        { time: "18:30", icon: "Utensils", title: "ÊôöÈ§ê", desc: "Nightcap Bistro (‰∫´Áî®Âë®ÂÖ≠ÊôöÊ∞õÂõ¥)" }
                    ]
                },
                {
                    day: 2,
                    date: "12Êúà07Êó• (Âë®Êó•)",
                    title: "Êê¨ÂÆ∂ & Ëê§ÁÅ´Ëô´ | Transition",
                    location: "Nerang -> Broadbeach",
                    summary: "ËΩªÊùæÁöÑ‰∏ÄÂ§©ÔºåÊôö‰∏äÂéªÁúãÁ•ûÂ•áÁöÑËê§ÁÅ´Ëô´„ÄÇ",
                    risks: [
                        { type: "info", msg: "Ëê§ÁÅ´Ëô´Â§úÊ∏∏ÁßªËá≥‰ªäÂ§©Êôö‰∏äÔºåÈò≤Ê≠¢ Day 4 ‰ΩìÂäõÈÄèÊîØ„ÄÇ" }
                    ],
                    timeline: [
                        { time: "09:00", icon: "Car", title: "Slideways Go Karting", desc: "Â∞±Âú®ÈÖíÂ∫óÊóÅÔºåÁé© 1.5 Â∞èÊó∂" },
                        { time: "11:00", icon: "Hotel", title: "ÈÄÄÊàø & ËΩ¨Áßª", desc: "Uber ÂâçÂæÄ Meriton BroadbeachÔºåÂØÑÂ≠òË°åÊùé" },
                        { time: "11:30", icon: "ShoppingBag", title: "Pacific Fair Â§ßÈááË¥≠", desc: "Brunch + Coles ÈááË¥≠Êú™Êù•5Â§©Êó©È§êÁâ©ËµÑ" },
                        { time: "15:00", icon: "CheckCircle", title: "Meriton ÂÖ•‰Ωè", desc: "Âº∫Âà∂‰ºëÊÅØÔºöÊï¥ÁêÜË°åÊùéÔºåÁù°‰∏™ÂçàËßâÊàñÊ≥≥Ê±†ÊîæÊùæ„ÄÇ" },
                        { time: "17:30", icon: "Utensils", title: "Âø´ÈÄüÊôöÈ§ê", desc: "The Oasis Ê•º‰∏ãÁÆÄÈ§êÔºåÂáÜÂ§áÂá∫Âèë" },
                        { time: "18:30", icon: "Navigation", title: "Ëê§ÁÅ´Ëô´Â§úÊ∏∏ (Êé•ÈÄÅ)", desc: "Springbrook National ParkÔºåÂæíÊ≠•ÁúãËìùÂÖâËô´" }
                    ]
                },
                {
                    day: 3,
                    date: "12Êúà08Êó• (Âë®‰∏Ä)",
                    title: "Êµ∑Ê¥ãÈú∏‰∏ª | Sea World",
                    location: "Broadbeach Base",
                    summary: "ÂÖ®Â§©Êµ∑Ê¥ãÂä®Áâ©‰∏éÊµ∑ÁªµÂÆùÂÆù„ÄÇ",
                    risks: [],
                    timeline: [
                        { time: "09:30", icon: "Navigation", title: "ÂâçÂæÄ Sea World", desc: "ËΩªËΩ®Âà∞ Surfers Paradise -> ËΩ¨ HoPo Ê∏°ËΩÆ (È£éÊôØÂ•Ω) Êàñ 705ÂÖ¨‰∫§" },
                        { time: "10:00", icon: "Ticket", title: "Sea World", desc: "Êµ∑Ë±öÁßÄ„ÄÅNickelodeon Land" },
                        { time: "16:00", icon: "Navigation", title: "ËøîÂõû Broadbeach", desc: "ËΩªËΩ® G:link" },
                        { time: "18:30", icon: "Utensils", title: "Êµ∑È≤úÂ§ßÈ§ê", desc: "Harvest Buffet (Â∞±Âú®ÈöîÂ£Å The Star)" }
                    ]
                },
                {
                    day: 4,
                    date: "12Êúà09Êó• (Âë®‰∫å)",
                    title: "Ëá™ÁÑ∂‰∏éÊµ∑Êª© | Nature (Lite)",
                    location: "Currumbin",
                    summary: "ÂáèË¥üÁâàË°åÁ®ãÔºöÂä®Áâ©Âõ≠+Êµ∑Êª©„ÄÇÊôö‰∏äÂΩªÂ∫ïË∫∫Âπ≥„ÄÇ",
                    risks: [
                        { type: "success", msg: "ÂáèË¥üÊàêÂäüÔºö‰ªäÊôöÊ≤°ÊúâÂÆâÊéíÔºå‰∏ãÂçàÂèØ‰ª•Â∞ΩÊÉÖÂú®ÂÖ¨ÂØìË∫∫Âπ≥ÊàñÊµ∑ËæπÁé©Ê≤ô„ÄÇ" }
                    ],
                    timeline: [
                        { time: "09:00", icon: "Navigation", title: "ÂâçÂæÄ Currumbin", desc: "ÂÖ¨‰∫§ 700/777 Áõ¥Ëææ" },
                        { time: "09:30", icon: "Camera", title: "Currumbin Wildlife Sanctuary", desc: "ÈáçÁÇπÔºöÂñÇÈπ¶Èπâ„ÄÅÊä±ËÄÉÊãâ" },
                        { time: "14:00", icon: "Sun", title: "Currumbin Alley Áé©Ê∞¥", desc: "Â¶ÇÊûú‰∏çÁ¥ØÂ∞±Áé©Ê∞¥ÔºåÁ¥Ø‰∫ÜÂ∞±ÂõûÈÖíÂ∫óÂçàÁù°" },
                        { time: "18:00", icon: "Utensils", title: "ÊôöÈ§ê", desc: "Mario's Italian (The Oasis) Êàñ Uber Eats" }
                    ]
                },
                {
                    day: 5,
                    date: "12Êúà10Êó• (Âë®‰∏â)",
                    title: "ÊøÄÊµÅÂãáËøõ | Wet'n'Wild",
                    location: "Inland / Surfers",
                    summary: "Ê∞¥‰∏ä‰πêÂõ≠Êó•„ÄÇÂê´ËØ¶ÁªÜÈõ®Â§©Â§áÊ°à„ÄÇ",
                    risks: [
                        { type: "warning", msg: "Ëã•‰∏ãÈõ®ÔºåËØ∑ÂàáÊç¢Ëá≥ Plan B ÂÆ§ÂÜÖÊñπÊ°à„ÄÇ" }
                    ],
                    timeline: weatherMode === 'sun' ? [
                        { time: "10:00", icon: "Car", title: "Uber ÂâçÂæÄ Wet'n'Wild", desc: "Á∫¶ 25 ÂàÜÈíüËΩ¶Á®ã (ÈÅøÂºÄÂë®Êú´‰∫∫ÊΩÆ)" },
                        { time: "10:30", icon: "Ticket", title: "ÁïÖÁé©Ê∞¥‰∏ñÁïå", desc: "Áõ¥Â•î Junior Âå∫ÔºåÊºÇÊµÅÊ≤≥" },
                        { time: "15:00", icon: "Car", title: "ËøîÂõûÈÖíÂ∫ó", desc: "ËΩ¶‰∏äË°•Ëßâ" },
                        { time: "18:00", icon: "Utensils", title: "ÊôöÈ§ê: Hurricane's Grill", desc: "Surfers Paradise (ÈúÄÈ¢ÑËÆ¢)" }
                    ] : [
                        { time: "10:00", icon: "Navigation", title: "ÂâçÂæÄ Surfers Paradise", desc: "ËΩªËΩ® G:link Áõ¥Ëææ" },
                        { time: "10:30", icon: "Ticket", title: "Infinity Gold Coast", desc: "ÂÖâÂΩ±Ëø∑ÂÆ´ÔºåDarren ÂøÖÁà±" },
                        { time: "12:30", icon: "Utensils", title: "ÂçàÈ§ê", desc: "Betty's Burgers" },
                        { time: "14:00", icon: "Ticket", title: "Ripley's / Timezone", desc: "‰ø°‰∏ç‰ø°Áî±‰Ω†ÂçöÁâ©È¶Ü Êàñ ÂÆ§ÂÜÖÊ∏∏ÊàèÂéÖ" },
                        { time: "18:00", icon: "Utensils", title: "ÊôöÈ§ê: Hurricane's Grill", desc: "Surfers Paradise (ÈúÄÈ¢ÑËÆ¢)" }
                    ]
                },
                {
                    day: 6,
                    date: "12Êúà11Êó• (Âë®Âõõ)",
                    title: "Ê∞¥‰∏äÊäâÊã© | City & Chill",
                    location: "Surfers Paradise",
                    summary: "Ê∞¥‰∏äÊ¥ªÂä®‰∫åÈÄâ‰∏ÄÔºåÊúÄÂêéÊü•ÊºèË°•Áº∫„ÄÇ",
                    risks: [],
                    timeline: [
                        { time: "10:00", icon: "Coffee", title: "Áù°‰∏™ÊáíËßâ", desc: "Meriton Èò≥Âè∞Êó©È§ê" },
                        { time: "11:00", icon: "Navigation", title: "ÈÄâÈ°πÔºöAquaduck (Ê∏©Âíå) Êàñ Jet Boat (Âà∫ÊøÄ)", desc: "Áé∞Âú∫ÂÜ≥ÂÆöÔºåÈÉΩÂú® Surfers Paradise" },
                        { time: "13:00", icon: "Utensils", title: "ÂçàÈ§ê", desc: "Surfers Paradise ÈöèÂøÉÈÄâ" },
                        { time: "15:00", icon: "Camera", title: "Q1 SkyPoint", desc: "ÁôªÈ´òÊúõËøúÔºåÊàñÂõûTimezoneÊâìÊ∏∏Êàè" },
                        { time: "18:00", icon: "Utensils", title: "Ê∏ÖÁ©∫ÂÜ∞ÁÆ±", desc: "ÊúÄÂêéÁöÑ‰∏ÄÊôöÔºåÁÆÄÂçïÂêÉ" }
                    ]
                },
                {
                    day: 7,
                    date: "12Êúà12Êó• (Âë®‰∫î)",
                    title: "Êª°ËΩΩËÄåÂΩí | Departure",
                    location: "Gold Coast -> Melbourne",
                    summary: "ÈÄÄÊàøÔºåÊúÄÂêéÁöÑÊµ∑Êª©Êó∂ÂÖâÔºå‰∏•ÊéßÈÄÅÊú∫Êó∂Èó¥„ÄÇ",
                    risks: [
                        { type: "critical", msg: "Âë®‰∫îÊôöÈ´òÂ≥∞ÊûÅÂÖ∂Êã•Â†µÔºÅÂøÖÈ°ªÂú® 17:00 ÂâçÂùê‰∏ä UberÔºå‰∏çÂèØËøüÁñë„ÄÇ" }
                    ],
                    timeline: [
                        { time: "10:00", icon: "Hotel", title: "ÈÄÄÊàø", desc: "Ë°åÊùéÂØÑÂ≠òÂâçÂè∞" },
                        { time: "10:30", icon: "Sun", title: "ÊúÄÂêéÁöÑÊµ∑Êª©/ÂïÜÂú∫", desc: "Kurrawa Beach Êàñ Pacific Fair" },
                        { time: "16:30", icon: "ShoppingBag", title: "ÂèñË°åÊùé", desc: "Êï¥ÁêÜÂÆåÊØïÔºå‰∏äÂéïÊâÄ" },
                        { time: "17:00", icon: "Car", title: "Uber ÂâçÂæÄÊú∫Âú∫ (Ê≠ªÁ∫ø)", desc: "È¢ÑÁïô 1 Â∞èÊó∂ËΩ¶Á®ãÂ∫îÂØπÂ†µËΩ¶" },
                        { time: "18:20", icon: "Utensils", title: "Êú∫Âú∫ÊôöÈ§ê", desc: "OOL Êú∫Âú∫ÂÜÖËß£ÂÜ≥" },
                        { time: "20:10", icon: "Plane", title: "Ëµ∑È£û (VA752)", desc: "ÂõûÂÆ∂ÔºÅ" }
                    ]
                }
            ];

            // --- 4. ÊôØÁÇπÊï∞ÊçÆ ---
            const attractions = {
                tier1: [
                    {
                        name: "Warner Bros. Movie World",
                        cnName: "ÂçéÁ∫≥ÁîµÂΩ±‰∏ñÁïå",
                        tag: "‚úÖ",
                        owner: "Village Roadshow (ÈÄöÁ•®ÂåÖÂê´)",
                        duration: "ÂÖ®Â§© (10:00 - 17:00)",
                        reason: "ÈªÑÈáëÊµ∑Â≤∏ÁöÑÁéãÁâå„ÄÇÂØπ‰∫é 7 Â≤ÅÁî∑Â≠©ÔºåËùôËù†‰æ†„ÄÅË∂Ö‰∫∫„ÄÅLooney Tunes ÁöÑÊ≤âÊµ∏ÊÑüÊûÅÂº∫„ÄÇ",
                        core: "È£ûËΩ¶ÊºÇÁßªÁâπÊäÄÁßÄ (Stunt Driver)„ÄÅÊòéÊòüÂ§ßÊ∏∏Ë°å„ÄÅÂÑøÁ´•È©æÈ©∂Â≠¶Ê†°„ÄÇ",
                        compare: "Êó† (None)„ÄÇÂ¢®Â∞îÊú¨Ê≤°ÊúâÂ•ΩËé±ÂùûÁîµÂΩ± IP ÁöÑÂ§ßÂûã‰∏ªÈ¢ò‰πêÂõ≠„ÄÇ"
                    },
                    {
                        name: "Sea World",
                        cnName: "Êµ∑Ê¥ã‰∏ñÁïå",
                        tag: "‚úÖ",
                        owner: "Village Roadshow (ÈÄöÁ•®ÂåÖÂê´)",
                        duration: "5-6 Â∞èÊó∂",
                        reason: "Âä®Áâ©Âõ≠ + Ê∏∏‰πêÂú∫ + ÁâπÊäÄÁßÄÁöÑÁªºÂêà‰Ωì„ÄÇÊµ∑ÁªµÂÆùÂÆùÂíåÂøçËÄÖÁ•ûÈæü‰∏ªÈ¢òÂå∫ÊòØÂ§ßÊùÄÂô®„ÄÇ",
                        core: "Êµ∑Ë±öË°®Êºî„ÄÅÊªëÊ∞¥ÁâπÊäÄÁßÄ„ÄÅNickelodeon Ê∏∏‰πêÂå∫„ÄÇ",
                        compare: "ÂÆåËÉú (Superior)„ÄÇÂ¢®Â∞îÊú¨Ê∞¥ÊóèÈ¶ÜÂè™ÊòØÂÆ§ÂÜÖËßÇËµèÔºåËøôÈáåÊòØÊà∑Â§ñÂ§ßÂûãÁªºÂêà‰πêÂõ≠„ÄÇ"
                    },
                    {
                        name: "Slideways Go Karting",
                        cnName: "ÂÆ§ÂÜÖÂç°‰∏ÅËΩ¶",
                        tag: "‚úÖ",
                        owner: "Áã¨Á´ãËøêËê• (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "1.5 - 2 Â∞èÊó∂",
                        reason: "3 Â±ÇÂÆ§ÂÜÖÁ´ã‰ΩìËµõÈÅìÈùûÂ∏∏ÁΩïËßÅ„ÄÇÂØπ‰∫é 7 Â≤Å DarrenÔºåËÉΩ‰∫≤Ëá™È©æÈ©∂ Cadet Kart ‰∏îÁ¶ªÁ¨¨‰∏ÄÂÆ∂ÈÖíÂ∫óÊûÅËøëÔºåÊàòÊúØ‰ª∑ÂÄºÈ´ò„ÄÇ",
                        core: "ÂÆ§ÂÜÖÂ§öÂ±ÇÁ´ã‰ΩìËµõÈÅìÁ´ûÈÄü„ÄÇ",
                        compare: "ËµõÈÅìÁªìÊûÑ‰∏çÂêå„ÄÇÂ¢®Â∞îÊú¨ÊúâÂç°‰∏ÅËΩ¶Ôºå‰ΩÜ Slideways ÁöÑÂ§öÂ±ÇÁ´ã‰ΩìÁªìÊûÑÊõ¥ÊúâË∂£Âë≥ÊÄß„ÄÇ"
                    },
                    {
                        name: "Currumbin Wildlife Sanctuary",
                        cnName: "Â∫ì‰º¶ÂÆæÈáéÁîüÂä®Áâ©Âõ≠",
                        tag: "‚úÖ",
                        owner: "Áã¨Á´ãËøêËê• (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "4-5 Â∞èÊó∂",
                        reason: "‰∫íÂä®ÊÄßÊúÄÂ•ΩÁöÑËá™ÁÑ∂‰øùÊä§Âå∫„ÄÇÊõ¥ÂéüÂßãÔºå‰∫íÂä®Êõ¥Âº∫„ÄÇ",
                        core: "ÂñÇÂΩ©ËôπÈπ¶ÈπâÔºàÂá†ÁôæÂè™ÂÅúÂú®Ë∫´‰∏äÔºâ„ÄÅÊä±ËÄÉÊãâ„ÄÇ",
                        compare: "ÊúâÊú¨Ë¥®Âå∫Âà´„ÄÇÁª¥Â∑ûÊ≥ïÂæãÁ¶ÅÊ≠¢Êã•Êä±ËÄÉÊãâÔºåÂ∫ì‰º¶ÂÆæÁöÑÈπ¶ÈπâÂñÇÈ£üËßÑÊ®°‰πüÊòØÁã¨ÂÆ∂ÁöÑ„ÄÇ"
                    },
                    {
                        name: "Springbrook National Park",
                        cnName: "Êò•Ê∫™ÂõΩÂÆ∂ÂÖ¨Âõ≠ - ËìùÂÖâËê§ÁÅ´Ëô´",
                        tag: "‚úÖ",
                        owner: "ÂõΩÂÆ∂ÂÖ¨Âõ≠ (ÈúÄÊä•Âõ¢ÊàñËá™È©æ)",
                        duration: "3.5 - 4 Â∞èÊó∂ (Â§úÈó¥Ë°åÁ®ã)",
                        reason: "‰∏ñÁïåÁ∫ßËá™ÁÑ∂Â•áËßÇÔºåÈªëÊöóÊ¥ûÁ©¥‰∏≠ÁöÑ‚ÄúÈì∂Ê≤≥‚Äù„ÄÇ",
                        core: "Natural Bridge ÂæíÊ≠•„ÄÅÁúãËìùÂÖâËê§ÁÅ´Ëô´„ÄÇ",
                        compare: "‰ΩìÈ™åÂçáÁ∫ß„ÄÇËøôÈáåÁöÑÊ¥ûÁ©¥ÊôØËßÇÊõ¥Â£Æ‰∏Ω„ÄÅÊõ¥ÊàêÁÜü„ÄÇ"
                    },
                    {
                        name: "Jet Boating",
                        cnName: "Âñ∑Ê∞îÂø´Ëâá",
                        tag: "üÜï ‚úÖ",
                        owner: "Áã¨Á´ãËøêËê• (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "1 Â∞èÊó∂",
                        reason: "ÈªÑÈáëÊµ∑Â≤∏ÊãõÁâåÊ∞¥‰∏äÊ¥ªÂä®„ÄÇÊØîÈ∏≠Â≠êËàπÂà∫ÊøÄÂæóÂ§öÔºåÂåÖÂê´ 360 Â∫¶ÊóãËΩ¨ÂíåÈ´òÈÄüÊºÇÁßª„ÄÇ",
                        core: "È´òÈÄüÊ∞¥‰∏äÊºÇÁßª„ÄÅÊÄ•ËΩ¨ÂºØ„ÄÅÊµ™Ëä±È£ûÊ∫Ö„ÄÇ",
                        compare: "‰ΩìÈ™åÂçáÁ∫ß„ÄÇÂ¢®Â∞îÊú¨ËôΩÁÑ∂‰πüÊúâÂø´ËâáÔºå‰ΩÜÂú®ÈªÑÈáëÊµ∑Â≤∏ÁöÑ Broadwater Ê∞¥ÂüüÁé©ÔºåÈ£éÊôØÂíåÊ∞õÂõ¥Êõ¥Â•Ω„ÄÇ"
                    }
                ],
                tier2: [
                    {
                        name: "Wet'n'Wild",
                        cnName: "ÁãÇÈáéÊ∞¥‰∏ñÁïå",
                        tag: "‚úÖ",
                        owner: "Village Roadshow (ÈÄöÁ•®ÂåÖÂê´)",
                        duration: "4-5 Â∞èÊó∂",
                        reason: "12 ÊúàÂàùÊòÜÂ£´ÂÖ∞ÁõõÂ§èÁé©Ê∞¥ÊòØÂàöÈúÄ„ÄÇ",
                        core: "Â∑®Â§ßÁöÑÂÑøÁ´•ÊàèÊ∞¥ÂüéÂ†°„ÄÅÊºÇÊµÅÊ≤≥„ÄÇ",
                        compare: "Ê∞îÂÄô‰ºòÂäø„ÄÇÂ¢®Â∞îÊú¨ 12 ÊúàÂàù‰∏ãÊ∞¥Â§™ÂÜ∑ÔºåËøôÈáåÊ≠£ÂΩìÊó∂„ÄÇ"
                    },
                    {
                        name: "Infinity Gold Coast",
                        cnName: "Êó†ÈôêÂπªË±°Â±ã",
                        tag: "üÜï ‚úÖ",
                        owner: "Áã¨Á´ãËøêËê• (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "45 ÂàÜÈíü - 1 Â∞èÊó∂",
                        reason: "ÊúÄ‰Ω≥Èõ®Â§©Â§áÊ°à„ÄÇÂÖÖÊª°ÂÖâÂΩ±ÁâπÊïà„ÄÅÊøÄÂÖâÂíåÈïúÂ≠êÁöÑËø∑ÂÆ´„ÄÇ",
                        core: "Á©øË∂ä 20 ‰∏™‰∏çÂêåÁöÑÂÖâÂΩ±ÁéØÂ¢ÉÔºåÊûÅÂÖ∑Êú™Êù•ÊÑü„ÄÇ",
                        compare: "Áã¨ÂÆ∂‰ΩìÈ™å„ÄÇÂ¢®Â∞îÊú¨Ê≤°ÊúâÂêåÁ±ªÁöÑÂÖâÂΩ±Ëø∑ÂÆ´ËÆæÊñΩ„ÄÇ"
                    },
                    {
                        name: "Aquaduck / Quack'rDuck",
                        cnName: "È∏≠Â≠êËàπ",
                        tag: "‚úÖ",
                        owner: "Áã¨Á´ãËøêËê• (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "1.5 Â∞èÊó∂",
                        reason: "ËΩ¶ËàπÂêà‰∏ÄÔºåÂÜ≤ÂÖ•Ê∞¥‰∏≠ÁöÑÁû¨Èó¥ÈùûÂ∏∏Âà∫ÊøÄ„ÄÇ",
                        core: "Â≠©Â≠êÂèØ‰ª•ÂùêÂú®È©æÈ©∂‰Ωç‚ÄúÂºÄËàπ‚ÄùÂπ∂Ëé∑ÂæóËØÅ‰π¶„ÄÇ",
                        compare: "Êó†„ÄÇÂ¢®Â∞îÊú¨Ê≤°Êúâ‰∏§Ê†ñËßÇÂÖâËΩ¶„ÄÇ"
                    },
                    {
                        name: "Hurricane's Grill",
                        cnName: "È£ìÈ£éÁÉßÁÉ§",
                        tag: "‚úÖ",
                        owner: "ËøûÈîÅÈ§êÈ•Æ (Surfers Paradise Â∫ó)",
                        duration: "1.5 - 2 Â∞èÊó∂ (ÊôöÈ§ê)",
                        reason: "Êæ≥Ê¥≤ÁÉ§ËÇãÊéíÂ§©Ëä±ÊùøÔºåËÇâÈ£üÂÆ∂Â∫≠ÊúùÂú£Âú∞„ÄÇ",
                        core: "ÊãõÁâåÂÖ®‰ªΩÁå™ËÇãÊéí (Pork Ribs)„ÄÇ",
                        compare: "ÂìÅÁâåÁã¨Âç†„ÄÇÂ¢®Â∞îÊú¨Ê≤°Êúâ Hurricane's„ÄÇ"
                    },
                    {
                        name: "Harvest Buffet",
                        cnName: "Êòü‰∫øËá™Âä©È§ê",
                        tag: "‚úÖ",
                        owner: "The Star Gold Coast",
                        duration: "2 Â∞èÊó∂ (ÊôöÈ§ê)",
                        reason: "Â∞±Âú®‰ΩèÂ§ÑÈöîÂ£ÅÔºåÊñπ‰æø‰∏î‰∏∞ÁõõÁöÑÊµ∑È≤úËá™Âä©„ÄÇ",
                        core: "Êó†ÈôêÈáèÊµ∑È≤ú„ÄÅÁîúÁÇπÂå∫„ÄÇ",
                        compare: "Âú∫ÊôØ‰ºòÂäø„ÄÇÊµ∑ËæπÂêÉÊµ∑È≤úËá™Âä©Êõ¥Â∫îÊôØ„ÄÇ"
                    },
                    {
                        name: "Ripley's Believe It or Not!",
                        cnName: "‰ø°‰∏ç‰ø°Áî±‰Ω†ÂçöÁâ©È¶Ü",
                        tag: "üÜï ‚úÖ",
                        owner: "Ripley Entertainment (ÈúÄÂçïÁã¨‰π∞Á•®)",
                        duration: "1.5 - 2 Â∞èÊó∂",
                        reason: "‰ºòË¥®Èõ®Â§©Â§áÊ°à„ÄÇ‰∫íÂä®ÊÄßÊûÅÂº∫„ÄÇ",
                        core: "Â•áË∂£Â±ïÂìÅ„ÄÅÊøÄÂÖâËø∑ÂÆ´ÊåëÊàò (LaseRace)„ÄÇ",
                        compare: "Êó†„ÄÇÂ¢®Â∞îÊú¨Ê≤°Êúâ Ripley's ÂçöÁâ©È¶Ü„ÄÇ"
                    },
                    {
                        name: "Broadbeach / Surfers Paradise",
                        cnName: "Êµ∑Êª©",
                        tag: "‚úÖ",
                        owner: "ÂÖ¨ÂÖ±Âå∫Âüü",
                        duration: "1-2 Â∞èÊó∂",
                        reason: "ÈªÑÈáëÊµ∑Â≤∏ÁöÑÁÅµÈ≠Ç„ÄÇ",
                        core: "Áé©Ê≤ô„ÄÅË∏©Ê∞¥„ÄÇ",
                        compare: "ÊôØËßÇÂ∑ÆÂºÇ„ÄÇÊµ™Êõ¥Â§ß„ÄÅÊ≤ôÊõ¥ÁªÜ„ÄÅÊ∞¥Êõ¥Ëìù„ÄÇ"
                    }
                ],
                tier3: [
                    {
                        name: "Holoverse Dinosaur World",
                        cnName: "ÂÖ®ÊÅØÊÅêÈæô‰∏ñÁïå",
                        tag: "üÜï ‚ö†Ô∏è",
                        owner: "Áã¨Á´ãËøêËê• (Southport)",
                        duration: "1 Â∞èÊó∂",
                        reason: "ÂÖ®ÊÅØÊäïÂΩ±‰ΩìÈ™åÔºåÂèØ‰ª•‚ÄúÂñÇ‚ÄùÈõ∑ÈæôÔºåÁúãÊÅêÈæôÂ≠µÂåñ„ÄÇ",
                        core: "ÂÖ®ÊÅØ‰∫íÂä®ÔºåÊó†ÈúÄ‰Ω©Êà¥ VR ÁúºÈïú„ÄÇ",
                        compare: "‰ΩìÈ™åÁã¨Áâπ„ÄÇËôΩÁÑ∂Â¢®Â∞îÊú¨Êúâ VR ‰ΩìÈ™åÈ¶ÜÔºå‰ΩÜËøôÁßçÂÖ®ÊÅØ‰πêÂõ≠ËæÉÂ∞ëËßÅ„ÄÇ"
                    },
                    {
                        name: "Timezone Surfers Paradise",
                        cnName: "Ë∂ÖÂ§ßÂÆ§ÂÜÖÊ∏∏ÊàèÂéÖ",
                        tag: "‚ö†Ô∏è",
                        owner: "TEEG",
                        duration: "1-2 Â∞èÊó∂",
                        reason: "Èù¢ÁßØÂ∑®Â§ßÔºåËÆæÊñΩÂÖ®„ÄÇ",
                        core: "‰øùÈæÑÁêÉ„ÄÅÁ¢∞Á¢∞ËΩ¶„ÄÅË°óÊú∫„ÄÇ",
                        compare: "È´òÂ∫¶ÈáçÂè†„ÄÇÂ¢®Â∞îÊú¨ Highpoint/Chadstone ‰πüÊúâ„ÄÇ"
                    },
                    {
                        name: "Pacific Fair",
                        cnName: "Â§™Âπ≥Ê¥ãË¥≠Áâ©‰∏≠ÂøÉ",
                        tag: "‚ö†Ô∏è",
                        owner: "AMP Capital",
                        duration: "3-4 Â∞èÊó∂",
                        reason: "ÁéØÂ¢ÉÂ•ΩÔºåÂ∞±Âú®ÂÆ∂Èó®Âè£„ÄÇ",
                        core: "‰πêÈ´òÂ∫ó„ÄÅ‰π¶Â∫ó„ÄÅÂêÉÈ•≠„ÄÇ",
                        compare: "Chadstone„ÄÇÂ¢®Â∞îÊú¨Êõ¥Â•Ω„ÄÇ"
                    },
                    {
                        name: "Paradise Country",
                        cnName: "Â§©Â†ÇÂÜúÂ∫Ñ",
                        tag: "‚ö†Ô∏è",
                        owner: "Village Roadshow (ÈÄöÁ•®ÂåÖÂê´)",
                        duration: "3 Â∞èÊó∂",
                        reason: "ÁªèÂÖ∏ÂÜúÂú∫„ÄÇ",
                        core: "Ââ™ÁæäÊØõ„ÄÇ",
                        compare: "È´òÂ∫¶ÈáçÂè†„ÄÇÂ¢®Â∞îÊú¨Âë®ËæπÂÜúÂú∫ÂæàÂ§ö„ÄÇ"
                    },
                    {
                        name: "Mario's Italian Restaurant",
                        cnName: "È©¨ÈáåÂ••ÊÑèÈ§ê",
                        tag: "‚ö†Ô∏è",
                        owner: "Áã¨Á´ãËøêËê•",
                        duration: "1.5 Â∞èÊó∂",
                        reason: "Á¶ªÂÆ∂ËøëÔºå‰∏çÂá∫Èîô„ÄÇ",
                        core: "ÊÑèÈù¢„ÄÅÊä´Ëê®„ÄÇ",
                        compare: "Â¢®Â∞îÊú¨ÂÆåËÉú„ÄÇLygon St Êõ¥Â•Ω„ÄÇ"
                    },
                    {
                        name: "Q1 SkyPoint",
                        cnName: "Q1 ËßÇÊôØÂè∞",
                        tag: "‚ö†Ô∏è",
                        owner: "Ardent Leisure (ÈÄöÁ•®‰∏çÂê´)",
                        duration: "1.5 Â∞èÊó∂",
                        reason: "Âú∞Ê†áÔºåËßÜÈáéÂ•Ω„ÄÇ",
                        core: "360Â∫¶‰øØÁû∞Êµ∑Â≤∏Á∫ø„ÄÇ",
                        compare: "Eureka Skydeck„ÄÇ‰ΩìÈ™åÈÄªËæë‰∏ÄËá¥„ÄÇ"
                    },
                    {
                        name: "Dreamworld",
                        cnName: "Ê¢¶Âπª‰∏ñÁïå",
                        tag: "‚ö†Ô∏è",
                        owner: "Ardent Leisure (ÈÄöÁ•®‰∏çÂê´)",
                        duration: "ÂÖ®Â§©",
                        reason: "Êæ≥Ê¥≤ÊúÄÂ§ß‰πêÂõ≠„ÄÇ",
                        core: "ËÄÅËôé„ÄÅÂúüËëóÊñáÂåñ„ÄÇ",
                        compare: "ÈÉ®ÂàÜÈáçÂè†„ÄÇÂ∑≤Êúâ Movie WorldÔºåÂÜçÂéªËøôÈáåÁï•ÊòæÈáçÂ§ç„ÄÇ"
                    },
                    {
                        name: "Mount Tamborine",
                        cnName: "Âù¶‰ºØÊûóÂ±±",
                        tag: "üÜï ‚ö†Ô∏è",
                        owner: "Â§ö‰∏™ÊôØÁÇπÁªÑÂêà",
                        duration: "ÂÖ®Â§© (ÈúÄÁßüËΩ¶/Ë∑üÂõ¢)",
                        reason: "ÊåñÁüø„ÄÅÊ†ëÈ°∂ÊåëÊàò„ÄÇ",
                        core: "Thunderbird Park„ÄÇ",
                        compare: "Â¢®Â∞îÊú¨ÊúâÁ±ª‰ºº„ÄÇDandenong Ranges ‰πüÊúâÊ†ëÈ°∂ÊåëÊàò„ÄÇ"
                    }
                ]
            };

            const renderIcon = (iconName) => {
                const IconComponent = Icons[iconName] || Icons.MapPin;
                return <IconComponent size={16} />;
            };

            const renderAttractionCard = (attraction) => (
                <div key={attraction.name} className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                    <div className="flex justify-between items-start mb-2">
                        <h3 className="font-bold text-gray-900 text-lg">{attraction.cnName} <span className="text-xs text-gray-500 font-normal">{attraction.name}</span></h3>
                        <span className="text-sm">{attraction.tag}</span>
                    </div>
                    <div className="space-y-2 text-sm text-gray-600">
                        <p><span className="font-semibold text-gray-700">ÊâÄÂ±û:</span> {attraction.owner}</p>
                        <p><span className="font-semibold text-gray-700">Êó∂Èïø:</span> {attraction.duration}</p>
                        <p><span className="font-semibold text-gray-700">ÁêÜÁî±:</span> {attraction.reason}</p>
                        <p><span className="font-semibold text-gray-700">Ê†∏ÂøÉ:</span> {attraction.core}</p>
                        <div className="bg-slate-50 p-2 rounded mt-2 text-xs">
                            <span className="font-bold text-slate-700">üÜö Â¢®Â∞îÊú¨:</span> {attraction.compare}
                        </div>
                    </div>
                </div>
            );

            const handleGeminiCall = async (type) => {
                setAiQueryType(type);
                setShowAiModal(true);
                setAiLoading(true);
                setAiResponse(null);

                const currentDay = itinerary[activeDay];
                const systemPrompt = `You are a helpful travel assistant for a family trip to Gold Coast (2 adults + 7yo boy).
                Current Day: ${currentDay.title} (${currentDay.date})
                Location: ${currentDay.location}
                Summary: ${currentDay.summary}
                Timeline: ${JSON.stringify(currentDay.timeline)}
                Accommodation: ${activeDay < 2 ? 'Nightcap Nerang' : 'Meriton Suites Broadbeach'}
                Transportation: Uber/Public Transport (No Car)
                `;

                let userPrompt = "";
                if (type === 'weather') {
                    userPrompt = `Based on the activities for this day (indoor/outdoor/water), suggest a practical outfit for the 7-year-old and the parents. Also, list 3 essential items to pack in the day bag. Keep it brief, friendly, and practical. Assume typical December Gold Coast weather (warm, humid, chance of storms).`;
                } else {
                    userPrompt = `Suggest 3 specific, family-friendly dining options (Lunch or Dinner) near the current location or activity area for this day. 
                    Focus on places with kids' menus, good value, or nice views. 
                    Exclude places already in the timeline. 
                    Format as a simple list with reasons why it's good for a 7-year-old.`;
                }

                if (!apiKey) {
                    setAiResponse("Á¶ªÁ∫øÊ®°ÂºèÔºöËØ∑ËøûÊé•ÁΩëÁªúÂπ∂ÈÖçÁΩÆ API Key ‰ª•‰ΩøÁî®Êô∫ËÉΩÂä©ÊâãÂäüËÉΩ„ÄÇ");
                    setAiLoading(false);
                    return;
                }

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: userPrompt }]
                            }],
                            systemInstruction: {
                                parts: [{ text: systemPrompt }]
                            }
                        })
                    });

                    const data = await response.json();
                    if (data.candidates && data.candidates[0].content) {
                        setAiResponse(data.candidates[0].content.parts[0].text);
                    } else {
                        setAiResponse("Êä±Ê≠âÔºåÊöÇÊó∂Êó†Ê≥ïËøûÊé•Âà∞Êô∫ËÉΩÂä©ÊâãÔºåËØ∑Á®çÂêéÂÜçËØï„ÄÇ");
                    }
                } catch (error) {
                    console.error("AI Error:", error);
                    setAiResponse("ÁΩëÁªúËøûÊé•ÈîôËØØÔºåËØ∑Ê£ÄÊü•ÊÇ®ÁöÑÁΩëÁªúËÆæÁΩÆ„ÄÇ");
                } finally {
                    setAiLoading(false);
                }
            };

            return (
                <div className="min-h-screen bg-slate-50 font-sans text-gray-800 pb-24">
                    {/* Header */}
                    <div className="bg-blue-600 text-white p-6 shadow-lg sticky top-0 z-40 safe-area-inset-top">
                        <div className="max-w-3xl mx-auto flex justify-between items-center">
                            <div>
                                <h1 className="text-2xl font-bold flex items-center gap-2">
                                    üèñÔ∏è Cedric's GC Plan
                                </h1>
                                <p className="text-blue-100 text-sm mt-1">v6.0 Final | 2 Adults + 7yo</p>
                            </div>
                            {/* AI Buttons in Header */}
                            <div className="flex gap-2">
                                <button 
                                    onClick={() => handleGeminiCall('weather')}
                                    className="bg-white/20 hover:bg-white/30 p-2 rounded-full text-white transition backdrop-blur-sm"
                                    title="Smart Outfit Advisor"
                                >
                                    <Icons.Sparkles size={20} />
                                </button>
                                <button 
                                    onClick={() => handleGeminiCall('food')}
                                    className="bg-white/20 hover:bg-white/30 p-2 rounded-full text-white transition backdrop-blur-sm"
                                    title="Hidden Gem Food Finder"
                                >
                                    <Icons.Utensils size={20} />
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* View Switcher */}
                    <div className="max-w-3xl mx-auto p-4 pb-0">
                        <div className="flex bg-gray-200 p-1 rounded-lg">
                            <button 
                                onClick={() => setViewMode('itinerary')}
                                className={`flex-1 py-2 text-sm font-bold rounded-md transition ${viewMode === 'itinerary' ? 'bg-white shadow text-blue-600' : 'text-gray-500 hover:text-gray-700'}`}
                            >
                                üóìÔ∏è Ë°åÁ®ãË°®
                            </button>
                            <button 
                                onClick={() => setViewMode('attractions')}
                                className={`flex-1 py-2 text-sm font-bold rounded-md transition ${viewMode === 'attractions' ? 'bg-white shadow text-blue-600' : 'text-gray-500 hover:text-gray-700'}`}
                            >
                                üìç ÊôØÁÇπÂõæÈâ¥
                            </button>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="max-w-3xl mx-auto p-4">
                        
                        {viewMode === 'itinerary' ? (
                            <>
                                {/* Navigation Tabs */}
                                <div className="flex overflow-x-auto gap-2 pb-4 mb-2 no-scrollbar">
                                    {itinerary.map((day, index) => (
                                        <button
                                            key={index}
                                            onClick={() => setActiveDay(index)}
                                            className={`flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors ${
                                                activeDay === index 
                                                    ? 'bg-blue-600 text-white shadow-md' 
                                                    : 'bg-white text-gray-600 hover:bg-gray-100 border border-gray-200'
                                            }`}
                                        >
                                            Day {day.day}
                                        </button>
                                    ))}
                                </div>

                                {/* Active Day Card */}
                                <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                    
                                    {/* Day Header */}
                                    <div className="bg-slate-50 p-5 border-b border-gray-100">
                                        <div className="flex justify-between items-start">
                                            <div>
                                                <h2 className="text-xl font-bold text-gray-900">{itinerary[activeDay].title}</h2>
                                                <p className="text-blue-600 font-medium">{itinerary[activeDay].date}</p>
                                            </div>
                                            <span className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-md font-semibold">
                                                {itinerary[activeDay].location}
                                            </span>
                                        </div>
                                        <p className="text-gray-600 mt-2 text-sm">{itinerary[activeDay].summary}</p>
                                    </div>

                                    {/* Special Control for Day 5 */}
                                    {activeDay === 5 && (
                                        <div className="p-4 bg-blue-50 border-b border-blue-100 flex gap-2 justify-center">
                                            <button 
                                                onClick={() => setWeatherMode('sun')}
                                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition ${weatherMode === 'sun' ? 'bg-orange-400 text-white shadow' : 'bg-white text-gray-600'}`}
                                            >
                                                <Icons.Sun size={16} /> Êô¥Â§©ÊñπÊ°à
                                            </button>
                                            <button 
                                                onClick={() => setWeatherMode('rain')}
                                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition ${weatherMode === 'rain' ? 'bg-indigo-500 text-white shadow' : 'bg-white text-gray-600'}`}
                                            >
                                                <Icons.CloudRain size={16} /> Èõ®Â§©Â§áÊ°à
                                            </button>
                                        </div>
                                    )}

                                    {/* Risk Alerts */}
                                    {itinerary[activeDay].risks.length > 0 && (
                                        <div className="p-4 space-y-2">
                                            {itinerary[activeDay].risks.map((risk, idx) => (
                                                <div key={idx} className={`p-3 rounded-lg border flex gap-3 text-sm ${
                                                    risk.type === 'critical' ? 'bg-red-50 border-red-200 text-red-800' :
                                                    risk.type === 'warning' ? 'bg-orange-50 border-orange-200 text-orange-800' :
                                                    risk.type === 'success' ? 'bg-green-50 border-green-200 text-green-800' :
                                                    'bg-blue-50 border-blue-200 text-blue-800'
                                                }`}>
                                                    <div className="flex-shrink-0 mt-0.5">
                                                        <Icons.AlertTriangle size={18} />
                                                    </div>
                                                    <span>{risk.msg}</span>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    {/* Timeline */}
                                    <div className="p-5">
                                        <div className="space-y-6 relative before:absolute before:inset-y-0 before:left-4 before:w-0.5 before:bg-gray-200">
                                            {itinerary[activeDay].timeline.map((item, idx) => (
                                                <div key={idx} className="relative flex gap-4">
                                                    <div className="flex-shrink-0 w-8 h-8 rounded-full bg-white border-2 border-blue-500 flex items-center justify-center text-blue-600 z-10">
                                                        {renderIcon(item.icon)}
                                                    </div>
                                                    <div className="flex-grow pt-1">
                                                        <div className="flex items-baseline justify-between mb-1">
                                                            <h3 className="font-bold text-gray-900">{item.title}</h3>
                                                            <span className="text-xs font-mono text-gray-500 bg-gray-100 px-2 py-0.5 rounded">
                                                                {item.time}
                                                            </span>
                                                        </div>
                                                        <p className="text-sm text-gray-600 leading-relaxed">{item.desc}</p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {/* Action Buttons for AI - Body Location */}
                                <div className="grid grid-cols-2 gap-4 mt-6">
                                    <button 
                                        onClick={() => handleGeminiCall('weather')}
                                        className="bg-indigo-600 hover:bg-indigo-700 text-white p-4 rounded-xl shadow-md flex flex-col items-center gap-2 transition"
                                    >
                                        <Icons.Sparkles size={24} />
                                        <span className="font-bold text-sm">‚ú® Á©øË°£‰∏éË£ÖÂ§áÂª∫ËÆÆ</span>
                                    </button>
                                    <button 
                                        onClick={() => handleGeminiCall('food')}
                                        className="bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-xl shadow-md flex flex-col items-center gap-2 transition"
                                    >
                                        <Icons.Utensils size={24} />
                                        <span className="font-bold text-sm">üçΩÔ∏è ÈôÑËøëÁæéÈ£üÊé®Ëçê</span>
                                    </button>
                                </div>

                                {/* Packing List / Tips Footer */}
                                <div className="mt-6 bg-slate-800 text-slate-300 rounded-xl p-5 text-sm mb-10">
                                    <h4 className="font-bold text-white mb-3 flex items-center gap-2">
                                        <Icons.CheckCircle size={16} /> ÊàòÂâçÊ£ÄÊü•Ê∏ÖÂçï
                                    </h4>
                                    <ul className="space-y-2 list-disc list-inside">
                                        <li>Day 0 Âá∫ÂèëÂâçÔºöÊãøÂà∞ Nightcap ÁöÑÂÖ•‰Ωè PIN Á†Å„ÄÇ</li>
                                        <li>Day 2 & 5ÔºöÊèêÂâçÈ¢ÑËÆ¢Ëê§ÁÅ´Ëô´Âõ¢Âíå Hurricane's ÊôöÈ§ê„ÄÇ</li>
                                        <li>Day 7ÔºöÂùöÊåÅ 17:00 Ê≠ªÁ∫øÂá∫ÂèëÂéªÊú∫Âú∫„ÄÇ</li>
                                        <li>Áâ©ËµÑÔºöÁªô Darren ÂáÜÂ§áÂ•Ω Child Go Card ÂíåÊ∞¥ÊØçË°£„ÄÇ</li>
                                    </ul>
                                </div>
                            </>
                        ) : (
                            <div className="space-y-8">
                                <section>
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-amber-600">
                                        üèÜ Tier 1: ÁªùÂØπÊ†∏ÂøÉ (Must-Haves)
                                    </h2>
                                    <div className="grid gap-4">
                                        {attractions.tier1.map(renderAttractionCard)}
                                    </div>
                                </section>
                                <section>
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-blue-600">
                                        üéñÔ∏è Tier 2: Âº∫ÂäõÊé®Ëçê (Highly Recommended)
                                    </h2>
                                    <div className="grid gap-4">
                                        {attractions.tier2.map(renderAttractionCard)}
                                    </div>
                                </section>
                                <section>
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-slate-500">
                                        üéóÔ∏è Tier 3: Â°´Ë°•Á©∫Ê°£ (Backup / Optional)
                                    </h2>
                                    <div className="grid gap-4">
                                        {attractions.tier3.map(renderAttractionCard)}
                                    </div>
                                </section>
                            </div>
                        )}
                    </div>

                    {/* AI Modal */}
                    {showAiModal && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
                            <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden max-h-[80vh] flex flex-col">
                                <div className="p-4 border-b border-gray-100 flex justify-between items-center bg-slate-50">
                                    <h3 className="font-bold text-gray-800 flex items-center gap-2">
                                        {aiQueryType === 'weather' ? <Icons.Sparkles className="text-indigo-600" size={18}/> : <Icons.Utensils className="text-orange-500" size={18}/>}
                                        {aiQueryType === 'weather' ? 'Êô∫ËÉΩÂá∫Ë°åÂª∫ËÆÆ' : 'ÁæéÈ£üÈõ∑Ëææ'}
                                    </h3>
                                    <button onClick={() => setShowAiModal(false)} className="text-gray-400 hover:text-gray-600">
                                        <Icons.X size={20} />
                                    </button>
                                </div>
                                
                                <div className="p-6 overflow-y-auto">
                                    {aiLoading ? (
                                        <div className="flex flex-col items-center justify-center py-8 text-gray-500 gap-3">
                                            <Icons.Loader className="animate-spin text-blue-600" size={32} />
                                            <p className="text-sm">Ê≠£Âú®ÂàÜÊûêÊÇ®ÁöÑË°åÁ®ã...</p>
                                        </div>
                                    ) : (
                                        <div className="prose prose-sm max-w-none">
                                            <div className="whitespace-pre-wrap text-gray-700 leading-relaxed">
                                                {aiResponse}
                                            </div>
                                        </div>
                                    )}
                                </div>

                                <div className="p-4 border-t border-gray-100 bg-slate-50 text-xs text-center text-gray-400">
                                    Powered by Gemini AI ‚ú®
                                </div>
                            </div>
                        </div>
                    )}

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ItineraryApp />);
    </script>
</body>
</html>